"use strict";(self.webpackChunkWAsP=self.webpackChunkWAsP||[]).push([[66],{8066:(L,d,r)=>{r.r(d),r.d(d,{SpecificationModule:()=>J});var o=r(3075),p=r(9808),v=r(9224),l=r(3251),u=r(3092),m=r(7531),f=r(7322),g=r(9764),h=r(4521),_=r(3588),N=r(8675),x=r(4004),t=r(5e3),S=r(130),M=r(5826),I=r(508);function C(n,s){if(1&n&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function T(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().editMode()}),t._uU(1,"Edit"),t.qZA()}}function b(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().onSubmit()}),t._uU(1,"Save"),t.qZA()}}function Z(n,s){if(1&n&&(t.TgZ(0,"mat-form-field",3)(1,"mat-label"),t._uU(2),t.qZA(),t._UZ(3,"input",19),t.qZA()),2&n){const e=s.$implicit,i=t.oxw().$implicit;t.xp6(2),t.Oqu(e),t.xp6(1),t.hYB("id","input_",e,"_",i.Run_No,""),t.s9C("value",i[e]),t.s9C("formControlName",e)}}function F(n,s){if(1&n&&(t.TgZ(0,"div")(1,"form",15)(2,"mat-tab",16)(3,"div",17)(4,"div"),t.YNc(5,Z,4,5,"mat-form-field",18),t.qZA()()()()()),2&n){const e=s.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("formGroup",i.createFormGroup(e)),t.xp6(1),t.MGl("label","Run ",e.Run_No,""),t.xp6(3),t.Q6J("ngForOf",i.SortedSpecList)}}function y(n,s){if(1&n&&(t.TgZ(0,"div")(1,"mat-tab-group",13),t.YNc(2,F,6,3,"div",14),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.Specifications)}}const A=[{path:"",component:(()=>{class n{constructor(e,i,a){this.dataService=e,this.alertService=i,this.specificationService=a,this.forms=[],this.formSubs=[],this.specFilter=new o.NI,this.filteredOptions=[],this.SpecLoaded=!1,this.Editing=!1,this.formLoaded=!1,this.Welders=[],this.SpecList=[],this.Specifications=[],this.SortedSpecList=["WPS_No","Welding_Code","Joint_type","Side","Position","Class","Size","Gas_Flux_Type","Current_Min","Current_Max","Voltage_Min","Voltage_Max","Polarity","TravelSpeed_Min","TravelSpeed_Max","InterpassTemp_Min","InterpassTemp_Max","HeatInput_Min","HeatInput_Max"],this.loadData()}ngOnInit(){this.specFilter.valueChanges.pipe((0,N.O)(""),(0,x.U)(e=>this._filter(e))).subscribe({next:e=>{this.filteredOptions=[];for(const i of e)this.filteredOptions.push(i.WPS_No)}})}SpecOnKey(e){const i=e.target;this.SpecLoaded=!1,this.Editing=!1,""!==i.value&&(this.Specifications=[],this.loadSpecification(i.value),this.forms=[],this.Specifications.forEach(a=>{this.createFormGroup(a)}),this.formLoaded=!0)}_filter(e){return this.SpecList.filter(i=>i.WPS_No.toString().includes(e))}loadData(){this.dataService.getMachines().subscribe({next:e=>{this.Machines=e.reduce(function(i,a){return i.push(a),i},[])},error:e=>{this.alertService.error(e)}}),this.dataService.getWelders().subscribe({next:e=>{this.Welders=e.reduce(function(i,a){return i.push(a),i},[])},error:e=>{this.alertService.error(e)}}),this.dataService.getSpecList().subscribe({next:e=>{this.SpecList=e.reduce(function(i,a){return i.push(a),i},[])},error:e=>{this.alertService.error(e)}}),this.dataService.getSpecList().subscribe({next:e=>{this.filteredOptions=e.reduce(function(i,a){return i.push(a.WPS_No),i},[])},error:e=>{this.alertService.error(e)}})}loadSpecification(e){this.specificationService.getSpec(e).subscribe({next:i=>{this.Specifications=[],this.Specifications=i.reduce(function(a,c){return a.push(c),a},[]),this.SpecLoaded=!0},error:i=>{this.alertService.error(i),this.Editing=!1,this.SpecLoaded=!1}})}onSubmit(){for(this.Editing=!this.Editing;this.forms.length;){let e=this.forms.pop();this.specificationService.updateSpecRun(e.value.WPS_No,e.value.Run_No,e.value).subscribe({error:c=>{this.alertService.error(c),this.SpecLoaded=!1},complete:()=>{this.alertService.success("Succesfully Saved!")}}),this.updateSpecificationFromForm(e.value)}}updateSpecificationFromForm(e){for(var i in e)this.Specifications[e.Run_No-1][i]=e[i]}createFormGroup(e){let i=this.getFormGroup(e.Run_No);return void 0===i&&(i=new o.cw({Run_No:new o.NI(e.Run_No),WPS_No:new o.NI(e.WPS_No),Welding_Code:new o.NI(e.Welding_Code),Joint_type:new o.NI(e.Joint_type),Side:new o.NI(e.Side),Position:new o.NI(e.Position),Class:new o.NI(e.Class),Size:new o.NI(e.Size),Gas_Flux_Type:new o.NI(e.Gas_Flux_Type),Current_Min:new o.NI(e.Current_Min),Current_Max:new o.NI(e.Current_Max),Voltage_Min:new o.NI(e.Voltage_Min),Voltage_Max:new o.NI(e.Voltage_Max),Polarity:new o.NI(e.Polarity),TravelSpeed_Min:new o.NI(e.TravelSpeed_Min),TravelSpeed_Max:new o.NI(e.TravelSpeed_Max),InterpassTemp_Min:new o.NI(e.InterpassTemp_Min),InterpassTemp_Max:new o.NI(e.InterpassTemp_Max),HeatInput_Min:new o.NI(e.HeatInput_Min),HeatInput_Max:new o.NI(e.HeatInput_Max)}),this.forms.length<this.Specifications.length&&this.forms.push(i)),i}getFormGroup(e){return 0!=this.forms.length?this.forms.find(i=>i.value.Run_No===e):void 0}editMode(){this.Editing||(this.Editing=!this.Editing)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S.Do),t.Y36(S.c9),t.Y36(M.S))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:24,vars:6,consts:[[1,"container"],[1,"row"],[1,"col-4"],["appearance","fill"],["type","text","placeholder","Select Specification","aria-label","Specification","matInput","",3,"formControl","matAutocomplete","keyup"],["autoActiveFirstOption",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","type","button",1,"btn","btn-warning","text-center"],["mat-flat-button","","class","btn btn-warning text-center","type","button",3,"click",4,"ngIf"],[4,"ngIf"],[3,"value"],["mat-flat-button","","type","button",1,"btn","btn-warning","text-center",3,"click"],["dynamicHeight",""],[4,"ngFor","ngForOf"],[3,"formGroup"],[3,"label"],[1,"mat-elevation-z4"],["appearance","fill",4,"ngFor","ngForOf"],["type","text","matInput","",3,"id","value","formControlName"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2),t.TgZ(3,"div",2)(4,"h1"),t._uU(5,"Specification View"),t.qZA()(),t._UZ(6,"div",2),t.qZA(),t.TgZ(7,"div",1)(8,"form")(9,"mat-form-field",3)(10,"mat-label"),t._uU(11,"Welding Procedure Specification"),t.qZA(),t.TgZ(12,"input",4),t.NdJ("keyup",function(c){return i.SpecOnKey(c)}),t.qZA(),t.TgZ(13,"mat-autocomplete",5,6),t.YNc(15,C,2,2,"mat-option",7),t.qZA()()()(),t.TgZ(16,"div",1)(17,"div",1)(18,"button",8),t._uU(19,"Add"),t.qZA(),t.YNc(20,T,2,0,"button",9),t.YNc(21,b,2,0,"button",9),t.qZA(),t.TgZ(22,"div",1),t.YNc(23,y,3,1,"div",10),t.qZA()()()),2&e){const a=t.MAs(14);t.xp6(12),t.Q6J("formControl",i.specFilter)("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",i.filteredOptions),t.xp6(5),t.Q6J("ngIf",!i.Editing&&i.SpecLoaded),t.xp6(1),t.Q6J("ngIf",i.Editing),t.xp6(2),t.Q6J("ngIf",i.SpecLoaded&&i.formLoaded)}},directives:[o._Y,o.JL,f.KE,f.hX,m.Nt,o.Fj,u.ZL,o.JJ,o.oH,u.XC,p.sg,I.ey,p.O5,l.SP,o.sg,l.uX,o.u],styles:[""]}),n})(),canActivate:[_.a1]}];let w=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[h.Bz.forChild(A)],h.Bz]}),n})(),J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.ez,o.UX,w,v.QW,l.Nh,u.Bb,f.lN,m.c,g.o9]]}),n})()}}]);