"use strict";(self.webpackChunkWAsP=self.webpackChunkWAsP||[]).push([[592],{6592:(j,h,s)=>{s.r(h),s.d(h,{RealtimeModule:()=>M});var T=s(3075),f=s(9808),u=s(9224),y=s(8045),v=s(9560),A=s(9764),x=s(9706),D=s(3588),t=s(5e3),m=s(792),p=s(7093);let Z=(()=>{class a{constructor(e,i){this.dataService=e,this.socketService=i,this.displayList=["Current","Voltage"],this.chartOption={xAxis:{id:0,type:"time",axisLabel:{rotate:90},minInterval:5},yAxis:[{id:0,type:"value",scale:!0,alignTicks:!0},{id:1,type:"value",scale:!0,alignTicks:!0}]}}ngOnInit(){this.updateChart()}ngOnDestroy(){}onChartInit(e){this.echartsInstance=e}updateChart(){console.log("Chart is updating");let e=function C(a){return a.map(n=>n.Time)}(this.Data),i=e.reduce(function(l,d){return l<d?l:d}),r=e.reduce(function(l,d){return l>d?l:d}),o=[],c=0;this.displayList.forEach(l=>{o.push({type:"line",data:S(this.Data,l,"Time"),showSymbol:!1,animation:!1,yAxisIndex:c++})});for(const[l,d]of Object.entries(g(this.Spec[0],e,"Current")))o.push({type:"line",data:d,showSymbol:!1,animation:!1,yAxisIndex:0});for(const[l,d]of Object.entries(g(this.Spec[0],e,"Voltage")))o.push({type:"line",data:d,showSymbol:!1,animation:!1,yAxisIndex:1});this.chartOption=function I(a,n,e,i,r){return a.series=n,a.xAxis.min=e,a.xAxis.max=i,a.xAxis.data=r,a}(this.chartOption,o,i,r,e)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(m.Do),t.Y36(m.$c))},a.\u0275cmp=t.Xpm({type:a,selectors:[["realtime-card"]],inputs:{Data:"Data",Spec:"Spec",Task:"Task"},decls:18,vars:5,consts:[[1,"realtime-widget"],[1,"row"],[1,"col-2"],[1,"col-8","justify-center"],[1,"col-4","justify-center"],["echarts","",1,"realtime-chart",3,"options","chartInit"]],template:function(e,i){1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title")(3,"div",1),t._UZ(4,"div",2),t.TgZ(5,"div",3),t._uU(6),t.qZA(),t._UZ(7,"div",2),t.qZA()(),t.TgZ(8,"mat-card-subtitle")(9,"div",1)(10,"div",4),t._uU(11),t.qZA(),t.TgZ(12,"div",4),t._uU(13),t.qZA(),t.TgZ(14,"div",4),t._uU(15),t.qZA()()()(),t.TgZ(16,"mat-card-content")(17,"div",5),t.NdJ("chartInit",function(o){return i.onChartInit(o)}),t.qZA()()()),2&e&&(t.xp6(6),t.hij("Machine ID: ",i.Task.MachineID,""),t.xp6(5),t.hij("Task ID: ",i.Task.TaskID,""),t.xp6(2),t.hij("Welder ID: ",i.Task.WelderID,""),t.xp6(2),t.hij("Run No: ",i.Task.RunNo,""),t.xp6(2),t.Q6J("options",i.chartOption))},directives:[u.a8,u.dk,u.n5,u.$j,u.dn,v._w],styles:[".realtime-chart[_ngcontent-%COMP%]{height:320px}.realtime-widget[_ngcontent-%COMP%]{width:320px}"]}),a})();function S(a,n,e){return a.map(i=>[i[e],parseFloat(i[n])])}function g(a,n,e){let i=a[e+"_Max"],r=a[e+"_Min"],o={};return o.max=n.map(c=>[c,parseFloat(i)]),o.min=n.map(c=>[c,parseFloat(r)]),o}function F(a,n){if(1&a&&(t.TgZ(0,"div",5),t._UZ(1,"realtime-card",6),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Q6J("Data",e.Data)("Spec",e.Spec)("Task",e.Task)}}const R=[{path:"dashboard",component:(()=>{class a{constructor(e,i,r){this.socketService=e,this.alertService=i,this.accountservice=r}ngOnInit(){this.accountservice.userValue&&this.socketService.getActiveMachines2().subscribe({next:e=>{let i=[];e.active.forEach(function(r){let o=r.TaskID,c={};c.Task=r,c.Spec=e[o].WPS,c.Data=e[o].RT,i.push(c)}),this.ActiveTasks=i},error:e=>{this.alertService.error(e)}})}ngOnDestroy(){this.socketService.tdSocketListener.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(m.$c),t.Y36(m.c9),t.Y36(m.BR))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:10,vars:1,consts:[[1,"content"],[1,"row"],[1,"col-4"],["fxLayout","row wrap","fxLayoutGap","8px grid"],["fxFlex","30%","fxFlex.xs","100%","fxFlex.sm","33%",4,"ngFor","ngForOf"],["fxFlex","30%","fxFlex.xs","100%","fxFlex.sm","33%"],[1,"realtime-widget",3,"Data","Spec","Task"]],template:function(e,i){1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"div",1),t._UZ(3,"div",2),t.TgZ(4,"div",2)(5,"h1"),t._uU(6,"Real Time Views"),t.qZA()(),t._UZ(7,"div",2),t.qZA(),t.TgZ(8,"div",3),t.YNc(9,F,2,3,"div",4),t.qZA()()()),2&e&&(t.xp6(9),t.Q6J("ngForOf",i.ActiveTasks))},directives:[p.xw,p.SQ,f.sg,p.yH,Z],encapsulation:2}),a})(),canActivate:[D.a1]}];let k=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[x.Bz.forChild(R)],x.Bz]}),a})(),M=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[f.ez,T.UX,k,u.QW,A.o9,v.Ns.forRoot({echarts:y})]]}),a})()}}]);