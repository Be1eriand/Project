<div class="filter">
  <div class="dashboard">
    <div class="pageTitle">
      <span class="iconsDash"><i class="icon fas fa-hourglass-half"></i></span>
      <span class="dashboard-heading">Weld History</span>
    </div>
    <mat-tab-group>
      <mat-tab label="by Task">
        <ng-template matTabContent>
          <div>
            <form
              class="weld-history-form"
              [formGroup]="taskForm"
              (ngSubmit)="taskSubmit()"
            >
              <mat-label>Select:</mat-label>
              <mat-form-field appearance="outline">
                <mat-label>Task ID</mat-label>
                <input
                  type="text"
                  (keyup)="taskOnKey($event)"
                  formControlName="taskID"
                  matInput
                  [matAutocomplete]="auto"
                  required
                />
                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                  <mat-option *ngFor="let task of filteredTasks" [value]="task">
                    {{ task }}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
              <button mat-raised-button color="submit" type="submit">
                Run Report
              </button>
              <button
                mat-raised-button
                (click)="accordion.openAll()"
                *ngIf="showTask"
              >
                Expand All
              </button>
              <button
                mat-raised-button
                (click)="accordion.closeAll()"
                *ngIf="showTask"
              >
                Collapse All
              </button>
            </form>
            <div *ngIf="showTask">
              <mat-accordion multi>
                <app-task-history
                  *ngFor="let t of task"
                  [task]="t"
                ></app-task-history>
              </mat-accordion>
            </div>
          </div>
        </ng-template>
      </mat-tab>

      <mat-tab label="by Welder">
        <ng-template matTabContent>
          <form
            class="weld-history-form"
            [formGroup]="welderForm"
            (ngSubmit)="welderSubmit()"
          >
            <mat-label>Select:</mat-label>
            <mat-form-field appearance="outline">
              <mat-label>Welder Name</mat-label>
              <input
                type="text"
                matInput
                (keyup)="welderOnKey($event)"
                formControlName="welderName"
                [matAutocomplete]="auto"
                required
              />
              <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                <mat-option
                  *ngFor="let welder of filteredWelders"
                  [value]="welder"
                >
                  {{ welder }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
            <button mat-raised-button color="submit" type="submit">
              Run Report
            </button>
            <button
              mat-raised-button
              (click)="accordion.openAll()"
              *ngIf="showWelder"
            >
              Expand All
            </button>
            <button
              mat-raised-button
              (click)="accordion.closeAll()"
              *ngIf="showWelder"
            >
              Collapse All
            </button>
          </form>

          <div *ngIf="showWelder">
            <mat-accordion multi>
              <app-task-history
                *ngFor="let t of task"
                [task]="t"
              ></app-task-history>
            </mat-accordion>
          </div>
        </ng-template>
      </mat-tab>

      <mat-tab label="by Machine">
        Machine ID
        <ng-template matTabContent>
          <form
            class="weld-history-form"
            [formGroup]="machineForm"
            (ngSubmit)="machineSubmit()"
          >
            <mat-label>Select:</mat-label>
            <mat-form-field appearance="outline">
              <mat-label>Machine</mat-label>
              <input
                type="text"
                (keyup)="machineOnKey($event)"
                formControlName="machineName"
                name="machineName"
                matInput
                [matAutocomplete]="auto"
                required
              />
              <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                <mat-option
                  *ngFor="let machine of filteredMachines"
                  [value]="machine"
                >
                  {{ machine }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
            <button mat-raised-button color="submit" type="submit">
              Run Report
            </button>
            <button
              mat-raised-button
              (click)="accordion.openAll()"
              *ngIf="showMachine"
            >
              Expand All
            </button>
            <button
              mat-raised-button
              (click)="accordion.closeAll()"
              *ngIf="showMachine"
            >
              Collapse All
            </button>
          </form>
          <div *ngIf="showMachine">
            <mat-accordion multi>
              <app-task-history
                *ngFor="let t of task"
                [task]="t"
              ></app-task-history>
            </mat-accordion>
          </div>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
